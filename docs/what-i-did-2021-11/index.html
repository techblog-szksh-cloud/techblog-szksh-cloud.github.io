<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="pinterest" content="nopin">
<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
<meta name="generator" content="Hugo 0.89.4" />



<link rel="canonical" href="https://techblog.szksh.cloud/what-i-did-2021-11/">


    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/solarized_dark.min.css">
    <title>2021-11 やったこと - melody</title>
    
<meta name="description" content="Job  AWS Control Tower  登録できてなかった Account を登録できた   AWS SSO  ユーザーへの案内・催促を行い、 IAM User から SSO に移行してもらった ローカルの開発で Access Key に依存していた部分に関して修正し、 Access Key なしでローカルで開発できるようにした(人によってはまだ Access Key に依存したツールを使っている  S3 Browser が SSO でなぜか動かないらしい(自分が Windows 持ってないので確認できてないけど Cyberduck が SSO サポートしていない   一部のユーザーの Access Key の deactivate 不要な IAM User のクリーニング 来月中には一部の例外を除き、移行を完了させたい SSO 出来ない人を SSO できるように対応した (同期対象の Group や、 Permission Set を追加したり) SSO に関する User 向け、 SRE 向けドキュメントを英語で書いた   aqua を更新し、 Access Token なしでも動くようにした(API call を減らし、 rate limit の問題を解決した Self Hosted in GitHub Actions  無事 Self Hosted で動かせるようになった 結果的に Self Hosted じゃなくても良かったのではという気はしている   AWS WAF  COUNT, BLOCK log を Lambda で抽出しようとしているが、なぜか COUNT log が抽出できていない あまり時間取れてない   Route53 のドメインのアカウントの移管 Lambda の CI/CD  実現したいことを言語化: https://github.">

<meta property="og:title" content="2021-11 やったこと - melody">
<meta property="og:type" content="article">
<meta property="og:url" content="https://techblog.szksh.cloud/what-i-did-2021-11/">
<meta property="og:image" content="https://techblog.szksh.cloud/images/default.png">
<meta property="og:site_name" content="melody">
<meta property="og:description" content="Job  AWS Control Tower  登録できてなかった Account を登録できた   AWS SSO  ユーザーへの案内・催促を行い、 IAM User から SSO に移行してもらった ローカルの開発で Access Key に依存していた部分に関して修正し、 Access Key なしでローカルで開発できるようにした(人によってはまだ Access Key に依存したツールを使っている  S3 Browser が SSO でなぜか動かないらしい(自分が Windows 持ってないので確認できてないけど Cyberduck が SSO サポートしていない   一部のユーザーの Access Key の deactivate 不要な IAM User のクリーニング 来月中には一部の例外を除き、移行を完了させたい SSO 出来ない人を SSO できるように対応した (同期対象の Group や、 Permission Set を追加したり) SSO に関する User 向け、 SRE 向けドキュメントを英語で書いた   aqua を更新し、 Access Token なしでも動くようにした(API call を減らし、 rate limit の問題を解決した Self Hosted in GitHub Actions  無事 Self Hosted で動かせるようになった 結果的に Self Hosted じゃなくても良かったのではという気はしている   AWS WAF  COUNT, BLOCK log を Lambda で抽出しようとしているが、なぜか COUNT log が抽出できていない あまり時間取れてない   Route53 のドメインのアカウントの移管 Lambda の CI/CD  実現したいことを言語化: https://github.">
<meta property="og:locale" content="ja_JP">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="melody">
<meta name="twitter:url" content="https://techblog.szksh.cloud/what-i-did-2021-11/">
<meta name="twitter:title" content="2021-11 やったこと - melody">
<meta name="twitter:description" content="Job  AWS Control Tower  登録できてなかった Account を登録できた   AWS SSO  ユーザーへの案内・催促を行い、 IAM User から SSO に移行してもらった ローカルの開発で Access Key に依存していた部分に関して修正し、 Access Key なしでローカルで開発できるようにした(人によってはまだ Access Key に依存したツールを使っている  S3 Browser が SSO でなぜか動かないらしい(自分が Windows 持ってないので確認できてないけど Cyberduck が SSO サポートしていない   一部のユーザーの Access Key の deactivate 不要な IAM User のクリーニング 来月中には一部の例外を除き、移行を完了させたい SSO 出来ない人を SSO できるように対応した (同期対象の Group や、 Permission Set を追加したり) SSO に関する User 向け、 SRE 向けドキュメントを英語で書いた   aqua を更新し、 Access Token なしでも動くようにした(API call を減らし、 rate limit の問題を解決した Self Hosted in GitHub Actions  無事 Self Hosted で動かせるようになった 結果的に Self Hosted じゃなくても良かったのではという気はしている   AWS WAF  COUNT, BLOCK log を Lambda で抽出しようとしているが、なぜか COUNT log が抽出できていない あまり時間取れてない   Route53 のドメインのアカウントの移管 Lambda の CI/CD  実現したいことを言語化: https://github.">
<meta name="twitter:image" content="https://techblog.szksh.cloud/images/default.png">


<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "NewsArticle",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id":"https:\/\/techblog.szksh.cloud\/"
    },
    "headline": "2021-11 やったこと - melody",
    "image": {
      "@type": "ImageObject",
      "url": "https:\/\/techblog.szksh.cloud\/images\/default.png",
      "height": 800,
      "width": 800
    },
    "datePublished": "2021-11-28T15:45:55JST",
    "dateModified": "2021-11-28T15:45:55JST",
    "author": {
      "@type": "Person",
      "name": "melody"
    },
    "publisher": {
      "@type": "Organization",
      "name": "melody",
      "logo": {
        "@type": "ImageObject",
        "url": "https:\/\/techblog.szksh.cloud\/images/logo.png",
        "width": 600,
        "height": 60
      }
    },
    "description": "Job  AWS Control Tower  登録できてなかった Account を登録できた   AWS SSO  ユーザーへの案内・催促を行い、 IAM User から SSO に移行してもらった ローカルの開発で Access Key に依存していた部分に関して修正し、 Access Key なしでローカルで開発できるようにした(人によってはまだ Access Key に依存したツールを使っている  S3 Browser が SSO でなぜか動かないらしい(自分が Windows 持ってないので確認できてないけど Cyberduck が SSO サポートしていない   一部のユーザーの Access Key の deactivate 不要な IAM User のクリーニング 来月中には一部の例外を除き、移行を完了させたい SSO 出来ない人を SSO できるように対応した (同期対象の Group や、 Permission Set を追加したり) SSO に関する User 向け、 SRE 向けドキュメントを英語で書いた   aqua を更新し、 Access Token なしでも動くようにした(API call を減らし、 rate limit の問題を解決した Self Hosted in GitHub Actions  無事 Self Hosted で動かせるようになった 結果的に Self Hosted じゃなくても良かったのではという気はしている   AWS WAF  COUNT, BLOCK log を Lambda で抽出しようとしているが、なぜか COUNT log が抽出できていない あまり時間取れてない   Route53 のドメインのアカウントの移管 Lambda の CI\/CD  実現したいことを言語化: https:\/\/github."
  }
</script>


    <link href="https://techblog.szksh.cloud/css/styles.css" rel="stylesheet">
    

  </head>

  <body>
    
    
    

    <header class="l-header">
      <nav class="navbar navbar-default">
        <div class="container">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://techblog.szksh.cloud/">melody</a>
          </div>

          

        </div>
      </nav>
    </header>

    <main>
      <div class="container">
        
<div class="row">
  <div class="col-md-8">

    <nav class="p-crumb">
      <ol class="breadcrumb">
        <li><a href="https://techblog.szksh.cloud/"><i class="fa fa-home" aria-hidden="true"></i></a></li>
        
        <li class="active">2021-11 やったこと</li>
      </ol>
    </nav>

    <article class="single">
  <header>
    <ul class="p-facts">
      <li><i class="fa fa-calendar" aria-hidden="true"></i><time datetime="2021-11-28T15:45:55JST">Nov 28, 2021</time></li>
      
      
    </ul>

    <h1 class="title">2021-11 やったこと</h1>
    
    
    <section>
      <div>
        <ul class="p-terms">
          
          <li><a href="https://techblog.szksh.cloud/tags/job/">job</a></li>
          
          <li><a href="https://techblog.szksh.cloud/tags/oss/">oss</a></li>
          
        </ul>
      </div>
    </section>
    
  </header>

  

  <div class="article-body"><h2 id="job">Job</h2>
<ul>
<li>AWS Control Tower
<ul>
<li>登録できてなかった Account を登録できた</li>
</ul>
</li>
<li>AWS SSO
<ul>
<li>ユーザーへの案内・催促を行い、 IAM User から SSO に移行してもらった</li>
<li>ローカルの開発で Access Key に依存していた部分に関して修正し、 Access Key なしでローカルで開発できるようにした(人によってはまだ Access Key に依存したツールを使っている
<ul>
<li>S3 Browser が SSO でなぜか動かないらしい(自分が Windows 持ってないので確認できてないけど</li>
<li>Cyberduck が SSO サポートしていない</li>
</ul>
</li>
<li>一部のユーザーの Access Key の deactivate</li>
<li>不要な IAM User のクリーニング</li>
<li>来月中には一部の例外を除き、移行を完了させたい</li>
<li>SSO 出来ない人を SSO できるように対応した (同期対象の Group や、 Permission Set を追加したり)</li>
<li>SSO に関する User 向け、 SRE 向けドキュメントを英語で書いた</li>
</ul>
</li>
<li>aqua を更新し、 Access Token なしでも動くようにした(API call を減らし、 rate limit の問題を解決した</li>
<li>Self Hosted in GitHub Actions
<ul>
<li>無事 Self Hosted で動かせるようになった</li>
<li>結果的に Self Hosted じゃなくても良かったのではという気はしている</li>
</ul>
</li>
<li>AWS WAF
<ul>
<li>COUNT, BLOCK log を Lambda で抽出しようとしているが、なぜか COUNT log が抽出できていない</li>
<li>あまり時間取れてない</li>
</ul>
</li>
<li>Route53 のドメインのアカウントの移管</li>
<li>Lambda の CI/CD
<ul>
<li>実現したいことを言語化: <a href="https://github.com/suzuki-shunsuke/issue/issues/70">https://github.com/suzuki-shunsuke/issue/issues/70</a></li>
<li>検討(あまり進んでない</li>
</ul>
</li>
<li>git-secrets から secretlint への移行</li>
<li>circleci-config-merge を CI で実行して自動修正するようにした</li>
</ul>
<h3 id="課題">課題</h3>
<ul>
<li>Renovate の Automerge が base branch が更新されたことで disable になり、結局手でマージしないといけなくなっている
<ul>
<li>自動化の検討</li>
</ul>
</li>
</ul>
<h2 id="blog-slide">Blog, Slide</h2>
<ul>
<li><a href="https://techblog.szksh.cloud/archives/2021/11/">https://techblog.szksh.cloud/archives/2021/11/</a>
<ul>
<li><a href="https://techblog.szksh.cloud/update-aqua-v0.7.16/">aqua の最近の update (v0.7.4 ~ v0.7.16)</a></li>
</ul>
</li>
<li><a href="https://dev.to/suzukishunsuke/opa-policy-testing-by-table-driven-test-289e">OPA Policy Testing by Table Driven Test</a></li>
<li><a href="https://suzuki-shunsuke.github.io/slides/aqua/introduction-5min/">https://suzuki-shunsuke.github.io/slides/aqua/introduction-5min/</a></li>
</ul>
<h2 id="oss">OSS</h2>
<p>aqua の公式サイトを立ち上げました。</p>
<p><a href="https://aquaproj.github.io/">https://aquaproj.github.io/</a></p>
<p><a href="https://docusaurus.io/">Docusaurus v2</a> で生成して、 GitHub Pages でホスティングしています。</p>
<p>aqua 用の GitHub Organization を作り、関連リポジトリを transfer しました。</p>
<p><a href="https://github.com/aquaproj">https://github.com/aquaproj</a></p>
<h3 id="oss-contribution">OSS Contribution</h3>
<p><a href="https://github.com/tfmigrator/cli">tfmigrator</a> と <a href="https://github.com/suzuki-shunsuke/tfcmt">tfcmt</a> を <a href="https://github.com/shuaibiyy/awesome-terraform">awesome-terraform</a> に追加してもらいました。</p>
<ul>
<li><a href="https://github.com/shuaibiyy/awesome-terraform/pull/139">https://github.com/shuaibiyy/awesome-terraform/pull/139</a></li>
<li><a href="https://github.com/shuaibiyy/awesome-terraform/pull/138">https://github.com/shuaibiyy/awesome-terraform/pull/138</a></li>
</ul>
<h2 id="その他">その他</h2>
<h3 id="このブログのリポジトリを別の-github-organization-に-transfer-しました">このブログのリポジトリを別の GitHub Organization に transfer しました</h3>
<p><a href="https://github.com/techblog-szksh-cloud/techblog-szksh-cloud.github.io">https://github.com/techblog-szksh-cloud/techblog-szksh-cloud.github.io</a></p>
<p>理由は techblog.szksh.cloud が suzuki-shunsuke.github.io の CNAME になっていて、
OSS のドキュメントなどを GitHub Pages で公開したいときに都合が悪かったからです。</p>
<p>ついでに CI を Drone から GitHub Actions に移行しました。</p>
<h3 id="suzuki-shunsukeissue-の活用">suzuki-shunsuke/issue の活用</h3>
<p><a href="https://github.com/suzuki-shunsuke/issue/issues">https://github.com/suzuki-shunsuke/issue/issues</a> に記録を残すようにしました。
前から使ってましたが、あまり活用できてなかったので、意識的に活用していきたいと思っています。
せっかくツールとかを検証しても、ちゃんと記録が残ってないと忘れてしまいもったいないというのと、
issue に残すと自然と検証とかが進むような気がしています。</p>
<h3 id="docusaurus">Docusaurus</h3>
<p>Docusaurus はいい感じなので <a href="https://github.com/suzuki-shunsuke/profile">suzuki-shunsuke/profile</a> やこのブログを Docusaurus に移行するのもありかもしれないなと思いました
(思っただけでまだ何もしてません</p>
<p>ただ、 OSS のドキュメントに Docusaurus を使う場合、個人的には package.json を同じリポジトリに置きたくないので、
同じリポジトリでプロダクトとドキュメントを管理しにくいかなという気はしています。</p>
</div>

  <footer class="article-footer">
    
    
    <section class="bordered">
      <header>
        <div class="panel-title">TAGS</div>
      </header>
      <div>
        <ul class="p-terms">
          
          <li><a href="https://techblog.szksh.cloud/tags/job/">job</a></li>
          
          <li><a href="https://techblog.szksh.cloud/tags/oss/">oss</a></li>
          
        </ul>
      </div>
    </section>
    
  </footer>

</article>


    
  </div>

  <div class="col-md-4">
    
<aside class="l-sidebar">

  <section class="panel panel-default">
    <div class="panel-heading">
      <div class="panel-title">LATESTS</div>
    </div>
    <div class="list-group">
      
      <a href="https://techblog.szksh.cloud/what-i-did-2021-11/" class="list-group-item">2021-11 やったこと</a>
      
      <a href="https://techblog.szksh.cloud/update-aqua-v0.7.16/" class="list-group-item">aqua の最近の update (v0.7.4 ~ v0.7.16)</a>
      
      <a href="https://techblog.szksh.cloud/what-i-did-2021-10/" class="list-group-item">2021-10 やったこと</a>
      
      <a href="https://techblog.szksh.cloud/what-i-did-2021-09/" class="list-group-item">2021-09 やったこと</a>
      
      <a href="https://techblog.szksh.cloud/aqua-global-configs/" class="list-group-item">aqua で組織・チームのツール群を管理</a>
      
      <a href="https://techblog.szksh.cloud/aqua-generate/" class="list-group-item">aqua の設定ファイルをインタラクティブに生成する generate コマンド</a>
      
      <a href="https://techblog.szksh.cloud/aqua-v0.5/" class="list-group-item">aqua v0.1.0 から v0.5.0 での変更点</a>
      
      <a href="https://techblog.szksh.cloud/what-i-did-2021-08/" class="list-group-item">2021-08 やったこと</a>
      
      <a href="https://techblog.szksh.cloud/aqua/" class="list-group-item">aqua - CLI ツールのバージョン管理</a>
      
      <a href="https://techblog.szksh.cloud/github-app-for-codebuild/" class="list-group-item">AWS CodeBuild を実行する Github App を作る</a>
      
    </div>
  </section>

  <section class="panel panel-default">
    <div class="panel-heading">
      <div class="panel-title">TAG</div>
    </div>
    <div class="list-group">
      
      <a href="https://techblog.szksh.cloud/tags/oss" class="list-group-item">oss (43)</a>
      
      <a href="https://techblog.szksh.cloud/tags/job" class="list-group-item">job (19)</a>
      
      <a href="https://techblog.szksh.cloud/tags/drone" class="list-group-item">drone (14)</a>
      
      <a href="https://techblog.szksh.cloud/tags/terraform" class="list-group-item">terraform (13)</a>
      
      <a href="https://techblog.szksh.cloud/tags/buildflow" class="list-group-item">buildflow (12)</a>
      
      <a href="https://techblog.szksh.cloud/tags/golang" class="list-group-item">golang (6)</a>
      
      <a href="https://techblog.szksh.cloud/tags/aqua" class="list-group-item">aqua (5)</a>
      
      <a href="https://techblog.szksh.cloud/tags/circleci" class="list-group-item">circleci (5)</a>
      
      <a href="https://techblog.szksh.cloud/tags/graylog" class="list-group-item">graylog (5)</a>
      
      <a href="https://techblog.szksh.cloud/tags/ansible" class="list-group-item">ansible (3)</a>
      
    </div>
  </section>

  <section class="panel panel-default">
    <div class="panel-heading">
      <div class="panel-title">ARCHIVE</div>
    </div>
    <div class="list-group">
      
      <a href="https://techblog.szksh.cloud/archives/2021/11" class="list-group-item">2021/11 (1)</a>
      
      <a href="https://techblog.szksh.cloud/archives/2021/10" class="list-group-item">2021/10 (3)</a>
      
      <a href="https://techblog.szksh.cloud/archives/2021/09" class="list-group-item">2021/09 (3)</a>
      
      <a href="https://techblog.szksh.cloud/archives/2021/08" class="list-group-item">2021/08 (3)</a>
      
      <a href="https://techblog.szksh.cloud/archives/2021/07" class="list-group-item">2021/07 (3)</a>
      
      <a href="https://techblog.szksh.cloud/archives/2021/06" class="list-group-item">2021/06 (1)</a>
      
      <a href="https://techblog.szksh.cloud/archives/2021/05" class="list-group-item">2021/05 (1)</a>
      
      <a href="https://techblog.szksh.cloud/archives/2021/04" class="list-group-item">2021/04 (4)</a>
      
      <a href="https://techblog.szksh.cloud/archives/2021/03" class="list-group-item">2021/03 (1)</a>
      
      <a href="https://techblog.szksh.cloud/archives/2021/02" class="list-group-item">2021/02 (3)</a>
      
    </div>
  </section>

</aside>


  </div>
</div>

      </div>
    </main>

    <footer class="l-footer">
      <div class="container">
        <p><span class="h-logo">&copy; melody</span></p>
        <aside>
          <p>Powered by <a href="https://gohugo.io/">Hugo</a>.</p>
          <p><a href="https://github.com/dim0627/hugo_theme_beg">Beg</a> designed by <a href="http://yet.unresolved.xyz/">Daisuke Tsuji</a>.</p>
        </aside>
      </div>
    </footer>

    <script src="//code.jquery.com/jquery-3.1.1.min.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>

